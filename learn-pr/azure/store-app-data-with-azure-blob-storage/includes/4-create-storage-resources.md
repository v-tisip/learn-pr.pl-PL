<span data-ttu-id="e201b-101">Gdy już wiemy, jak będą przechowywane dane na kontach magazynu, w kontenerach i obiektach blob, możemy zastanowić się, jakie zasoby platformy Azure trzeba utworzyć, aby zapewnić obsługę aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e201b-101">Once we have an idea of how we're going to store data across storage accounts, containers and blobs, we can think about the Azure resources we need to create to support the app.</span></span>

### <a name="storage-accounts"></a><span data-ttu-id="e201b-102">Konta magazynu</span><span class="sxs-lookup"><span data-stu-id="e201b-102">Storage accounts</span></span>

<span data-ttu-id="e201b-103">Tworzenie konta magazynu jest działaniem administracyjnym/zarządzania, które ma miejsce przed wdrożeniem i uruchomieniem aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e201b-103">Storage account creation is an administrative/management activity that takes place prior to deploying and running your app.</span></span> <span data-ttu-id="e201b-104">Konta są zwykle tworzone przez skrypt konfigurowania wdrożenia lub środowiska, szablon usługi Azure Resource Manager lub ręcznie przez administratora.</span><span class="sxs-lookup"><span data-stu-id="e201b-104">Accounts are usually created by a deployment or environment setup script, an Azure Resource Manager template, or manually by an administrator.</span></span> <span data-ttu-id="e201b-105">Aplikacje inne niż narzędzia administracyjne zwykle nie mają uprawnień do tworzenia kont magazynu.</span><span class="sxs-lookup"><span data-stu-id="e201b-105">Applications other than administrative tools generally should not have permissions to create storage accounts.</span></span>

### <a name="containers"></a><span data-ttu-id="e201b-106">Containers</span><span class="sxs-lookup"><span data-stu-id="e201b-106">Containers</span></span>

<span data-ttu-id="e201b-107">W odróżnieniu od tworzenia konta magazynu, tworzenie kontenera jest prostym działaniem, które można wykonywać z poziomu aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e201b-107">Unlike storage account creation, container creation is a lightweight activity that makes sense to perform from within an app.</span></span> <span data-ttu-id="e201b-108">Nie jest niczym niezwykłym tworzenie i usuwanie kontenerów w ramach zadań wykonywanych przez aplikację.</span><span class="sxs-lookup"><span data-stu-id="e201b-108">It's not uncommon for apps to create and delete containers as part of their work.</span></span>

<span data-ttu-id="e201b-109">W przypadku aplikacji bazujących na znanym zbiorze kontenerów z zapisanymi na stałe lub wstępnie skonfigurowanymi nazwami typową praktyką jest umożliwianie aplikacji utworzenia potrzebnych kontenerów, o ile jeszcze nie istnieją, po uruchomieniu lub przy pierwszym użyciu.</span><span class="sxs-lookup"><span data-stu-id="e201b-109">For apps that rely on a known set of containers with hard-coded or preconfigured names, typical practice is to let the app create the containers it needs on startup or first usage if they don't already exist.</span></span> <span data-ttu-id="e201b-110">Zezwolenie aplikacji na utworzenie kontenerów zamiast zrobienia tego podczas wdrażania aplikacji eliminuje konieczność znajomości nazw kontenerów używanych przez aplikację jednocześnie w aplikacji i procesie wdrażania.</span><span class="sxs-lookup"><span data-stu-id="e201b-110">Letting your app create containers instead of doing it as part of your app's deployment eliminates the need for both your application and your deployment process to know the names of the containers the app uses.</span></span>

## <a name="exercise"></a><span data-ttu-id="e201b-111">Ćwiczenie</span><span class="sxs-lookup"><span data-stu-id="e201b-111">Exercise</span></span>

<span data-ttu-id="e201b-112">Dokończymy niegotową aplikację platformy ASP.NET Core, dodając kod odpowiedzialny za korzystanie z usługi Azure Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="e201b-112">We're going to complete an unfinished ASP.NET Core app by adding code to use Azure Blob storage.</span></span> <span data-ttu-id="e201b-113">To ćwiczenie bardziej koncentruje się na poznawaniu interfejsu API usługi Blob Storage niż projektowaniu organizacji i schematu nazewnictwa, ale poniżej przedstawiono krótki przegląd aplikacji i sposobu przechowywania przez nią danych:</span><span class="sxs-lookup"><span data-stu-id="e201b-113">This exercise is more about exploring the Blob storage API than it is about designing an organization and naming scheme, but here's a quick overview of the app and how it stores data:</span></span>

<span data-ttu-id="e201b-114">**TODO zrzut ekranu aplikacji, ponieważ aż do zakończenia nie będzie on widoczny**</span><span class="sxs-lookup"><span data-stu-id="e201b-114">**TODO screenshot of app, since they're not going to see it run until the end**</span></span>

<span data-ttu-id="e201b-115">Nasza aplikacja działa jak folder udostępniony, który akceptuje przekazywane pliki i udostępnia je do pobrania.</span><span class="sxs-lookup"><span data-stu-id="e201b-115">Our app works like a shared folder that accepts file uploads and makes them available for download.</span></span> <span data-ttu-id="e201b-116">Nie używa bazy danych do organizowania obiektów blob &mdash; zamiast tego oczyszcza nazwy przekazanych plików i używa ich bezpośrednio jako nazw obiektów blob.</span><span class="sxs-lookup"><span data-stu-id="e201b-116">It doesn't use a database for organizing blobs &mdash; instead, it sanitizes the names of uploaded files and uses them as blob names directly.</span></span> <span data-ttu-id="e201b-117">Wszystkie przekazane pliki są przechowywane w jednym kontenerze.</span><span class="sxs-lookup"><span data-stu-id="e201b-117">All uploaded files are stored in a single container.</span></span>

<span data-ttu-id="e201b-118">Kod, od którego zaczniemy, kompiluje się i uruchamia, ale części odpowiedzialne za przechowywanie i ładowanie danych są puste.</span><span class="sxs-lookup"><span data-stu-id="e201b-118">The code we'll start with compiles and runs, but the parts responsible for storing and loading data are empty.</span></span> <span data-ttu-id="e201b-119">Gdy uzupełnimy kod, wdrożymy aplikację w usłudze Azure App Service i ją przetestujemy.</span><span class="sxs-lookup"><span data-stu-id="e201b-119">After we complete the code, we'll deploy the app to Azure App Service and test it.</span></span>

<span data-ttu-id="e201b-120">Skonfigurujmy infrastrukturę magazynu dla naszej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="e201b-120">Let's set up the storage infrastructure for our app.</span></span>

### <a name="resource-group-and-storage-account"></a><span data-ttu-id="e201b-121">Grupa zasobów i konto magazynu</span><span class="sxs-lookup"><span data-stu-id="e201b-121">Resource group and storage account</span></span>
<span data-ttu-id="e201b-122">Najpierw utworzymy grupę zasobów dla wszystkich zasobów w tym ćwiczeniu.</span><span class="sxs-lookup"><span data-stu-id="e201b-122">First, we'll create a resource group to contain all of the resources in this exercise.</span></span> <span data-ttu-id="e201b-123">Usuniemy ją na końcu, aby wyczyścić wszystko, co utworzymy.</span><span class="sxs-lookup"><span data-stu-id="e201b-123">We'll delete it at the end to clean up everything we create.</span></span> <span data-ttu-id="e201b-124">Utworzymy też konto magazynu, na którym aplikacja będzie przechowywać obiekty blob.</span><span class="sxs-lookup"><span data-stu-id="e201b-124">We'll also create the storage account our app will use to store blobs.</span></span>

<span data-ttu-id="e201b-125">Użyj terminala usługi Azure Cloud Shell, aby utworzyć grupę zasobów i konto magazynu, uruchamiając następujące polecenia interfejsu wiersza polecenia platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="e201b-125">Use the Azure Cloud Shell terminal to create the resource group and storage account by running the following Azure CLI commands.</span></span> <span data-ttu-id="e201b-126">Musisz podać unikatową nazwę konta magazynu &mdash; zanotuj ją do późniejszego użycia.</span><span class="sxs-lookup"><span data-stu-id="e201b-126">You'll need to provide a unique name for the storage account &mdash; make a note of it for later.</span></span> <span data-ttu-id="e201b-127">Wybór regionu `eastus` dla lokalizacji jest arbitralny.</span><span class="sxs-lookup"><span data-stu-id="e201b-127">The choice of `eastus` for the location is arbitrary.</span></span>

```console
az group create --name blob-exercise-group --location eastus
az storage account create --name <your-unique-storage-account-name> --resource-group blob-exercise-group --location eastus --kind StorageV2
```

<span data-ttu-id="e201b-128">**TODO poniżej powinien się znaleźć moduł usługi Azure Storage**</span><span class="sxs-lookup"><span data-stu-id="e201b-128">**TODO below should go in Azure Storage module**</span></span>

> [!NOTE]
> <span data-ttu-id="e201b-129">Dlaczego `--kind StorageV2`?</span><span class="sxs-lookup"><span data-stu-id="e201b-129">Why `--kind StorageV2`?</span></span> <span data-ttu-id="e201b-130">Istnieje kilka różnych rodzajów kont magazynu.</span><span class="sxs-lookup"><span data-stu-id="e201b-130">There are a few different kinds of storage accounts.</span></span> <span data-ttu-id="e201b-131">W większości scenariuszy powinno się używać kont magazynu ogólnego przeznaczenia w wersji 2 (oznaczonych jako `StorageV2`).</span><span class="sxs-lookup"><span data-stu-id="e201b-131">For most scenarios, you should use general-purpose v2 storage accounts (signified with `StorageV2`).</span></span> <span data-ttu-id="e201b-132">Jedyną przyczyną, dla której konta magazynu w wersji 2 muszą być określone w tym miejscu, jest to, że nadal są dość nowe i nie zostały jeszcze ustawione jako domyślne w witrynie Azure Portal i interfejsie wiersza polecenia platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="e201b-132">The only reason v2 storage accounts need to be specified here is that they are still fairly new and have not yet been made the default in the Azure Portal or the Azure CLI.</span></span>

### <a name="container"></a><span data-ttu-id="e201b-133">Kontener</span><span class="sxs-lookup"><span data-stu-id="e201b-133">Container</span></span>
<span data-ttu-id="e201b-134">Aplikacja, nad którą będziemy pracować w tym module, używa jednego kontenera.</span><span class="sxs-lookup"><span data-stu-id="e201b-134">The app we'll be working with in this module uses a single container.</span></span> <span data-ttu-id="e201b-135">Zamierzamy zastosować najlepsze rozwiązanie polegające na umożliwieniu aplikacji utworzenia kontenera przy uruchamianiu.</span><span class="sxs-lookup"><span data-stu-id="e201b-135">We're going to follow the best practice of letting the app create the container at startup.</span></span> <span data-ttu-id="e201b-136">Kontener można też jednak utworzyć z poziomu interfejsu wiersza polecenia platformy Azure: uruchom polecenie `az storage container create -h` w terminalu usługi Cloud Shell, jeśli chcesz zobaczyć dokumentację.</span><span class="sxs-lookup"><span data-stu-id="e201b-136">However, container creation can be done from the Azure CLI: run `az storage container create -h` in the Cloud Shell terminal if you'd like to see the documentation.</span></span>
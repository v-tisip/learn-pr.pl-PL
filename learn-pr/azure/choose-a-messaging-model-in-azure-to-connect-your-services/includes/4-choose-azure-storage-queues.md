<span data-ttu-id="ae536-101">Załóżmy, że planujesz architekturę aplikacji do udostępniania muzyki.</span><span class="sxs-lookup"><span data-stu-id="ae536-101">Suppose you are planning the architecture for your music-sharing application.</span></span> <span data-ttu-id="ae536-102">Chcesz upewnić się, że pliki muzyczne są bezproblemowo przekazywane do internetowego interfejsu API z aplikacji mobilnej.</span><span class="sxs-lookup"><span data-stu-id="ae536-102">You want to choose ensure that music files are uploaded to the web API reliably from the mobile app.</span></span>

<span data-ttu-id="ae536-103">Rozumiesz, że ta komunikacja powinna mieć formę komunikatu, i musisz wybrać, czy chcesz użyć kolejki usługi Azure Storage lub usługi Service Bus. Obydwa te rozwiązania mogą być używane do przechowywania kolejki komunikatów oczekujących na przetworzenie.</span><span class="sxs-lookup"><span data-stu-id="ae536-103">Having understood that this communication should be a message, you must choose whether to use Azure Storage queues or Service Bus, both of which can be used to store queues of messages as they await processing.</span></span>

## <a name="delivery-guarantees"></a><span data-ttu-id="ae536-104">Gwarancje dotyczące dostarczania</span><span class="sxs-lookup"><span data-stu-id="ae536-104">Delivery Guarantees</span></span>

<span data-ttu-id="ae536-105">Systemy kolejkowania zwykle gwarantują dostarczanie każdego komunikatu w kolejce do składnika docelowego.</span><span class="sxs-lookup"><span data-stu-id="ae536-105">Queuing systems usually guarantee delivery of each message in the queue to a destination component.</span></span> <span data-ttu-id="ae536-106">Jednak te gwarancje mogą korzystać z różnych podejść:</span><span class="sxs-lookup"><span data-stu-id="ae536-106">However, these guarantees can take different approaches:</span></span>

- <span data-ttu-id="ae536-107">**Co najmniej jednokrotne dostarczanie.**</span><span class="sxs-lookup"><span data-stu-id="ae536-107">**At-Least-Once Delivery.**</span></span> <span data-ttu-id="ae536-108">To podejście gwarantuje, że każdy komunikat zostanie dostarczony do co najmniej jednego ze składników, które pobierają komunikaty z kolejki.</span><span class="sxs-lookup"><span data-stu-id="ae536-108">In this approach, each message is guaranteed to be delivered to at least one of the components that retrieve messages from the queue.</span></span> <span data-ttu-id="ae536-109">Należy jednak pamiętać, że w pewnych okolicznościach ten sam komunikat może zostać dostarczony więcej niż raz.</span><span class="sxs-lookup"><span data-stu-id="ae536-109">Note, however, that in certain circumstances, it is possible that the same message may be delivered more than once.</span></span> <span data-ttu-id="ae536-110">Jeśli na przykład istnieją dwa wystąpienia aplikacji internetowej pobierającej komunikaty z kolejki, zazwyczaj każdy komunikat przechodzi tylko do jednego z tych wystąpień.</span><span class="sxs-lookup"><span data-stu-id="ae536-110">For example, if there are two instances of a web app retrieving messages from a queue, ordinarily each message goes to only one of those instances.</span></span> <span data-ttu-id="ae536-111">Jeśli jednak jedno wystąpienie przez dłuższy czas przetwarza komunikat, a limit czasu upłynie, komunikat może również zostać wysłany do drugiego wystąpienia.</span><span class="sxs-lookup"><span data-stu-id="ae536-111">However, if one instance takes a long time to process the message, and a time-out expires, the message may be sent to the other instance as well.</span></span> <span data-ttu-id="ae536-112">Należy pamiętać o tej możliwości, projektując kod aplikacji internetowej.</span><span class="sxs-lookup"><span data-stu-id="ae536-112">Your web app code should be designed with this possibility in mind.</span></span>
- <span data-ttu-id="ae536-113">**Co najwyżej jednokrotne dostarczanie.**</span><span class="sxs-lookup"><span data-stu-id="ae536-113">**At-Most-Once Delivery.**</span></span> <span data-ttu-id="ae536-114">To podejście nie gwarantuje dostarczenia każdego komunikatu. Istnieje bardzo mała szansa, że nie zostanie on dostarczony.</span><span class="sxs-lookup"><span data-stu-id="ae536-114">In this approach, each message is not guaranteed to be delivered and there is a very small chance that it may not arrive.</span></span> <span data-ttu-id="ae536-115">Komunikat nie zostanie jednak dostarczony dwukrotnie, tak jak w przypadku co najmniej jednego dostarczania.</span><span class="sxs-lookup"><span data-stu-id="ae536-115">However, there is no chance that the message will be delivered twice as with At-Least-Once delivery.</span></span>
- <span data-ttu-id="ae536-116">**Pierwszy na wejściu — pierwszy na wyjściu (FIFO).**</span><span class="sxs-lookup"><span data-stu-id="ae536-116">**First-In-First-Out (FIFO).**</span></span> <span data-ttu-id="ae536-117">W większości systemów obsługi komunikatów komunikaty zazwyczaj opuszczają kolejkę w tej samej kolejności, w której zostały dodane, ale należy rozważyć, czy ta kolejność jest gwarantowana.</span><span class="sxs-lookup"><span data-stu-id="ae536-117">In most messaging system, messages usually leave the queue in the same order in which they were added but you should consider whether this order is guaranteed.</span></span> <span data-ttu-id="ae536-118">Jeśli aplikacja rozproszona wymaga, aby komunikaty były przetwarzane dokładnie w prawidłowej kolejności, należy wybrać system kolejki, który oferuje gwarancję FIFO.</span><span class="sxs-lookup"><span data-stu-id="ae536-118">If your distributed application requires that messages are processed in precisely the correct order, you must choose a queue system that includes a FIFO guarantee.</span></span>

## <a name="transactions"></a><span data-ttu-id="ae536-119">Transakcje</span><span class="sxs-lookup"><span data-stu-id="ae536-119">Transactions</span></span>

<span data-ttu-id="ae536-120">Niektóre ściśle powiązane grupy komunikatów mogą powodować problemy, gdy jeden z komunikatów w grupie nie zostanie prawidłowo dostarczony.</span><span class="sxs-lookup"><span data-stu-id="ae536-120">Some closely related groups of messages may cause problems when delivery fails for one message in the group.</span></span>

<span data-ttu-id="ae536-121">Rozważmy na przykład aplikację handlu elektronicznego.</span><span class="sxs-lookup"><span data-stu-id="ae536-121">For example, consider an e-commerce application.</span></span> <span data-ttu-id="ae536-122">Gdy użytkownik kliknie przycisk „Kup”, zostanie wysłany komunikat ze szczegółami zamówienia oraz komunikat ze szczegółami karty kredytowej.</span><span class="sxs-lookup"><span data-stu-id="ae536-122">When the user clicks the "Buy" button, a message with the order details is sent along with a message with the credit card details.</span></span> <span data-ttu-id="ae536-123">Jeśli komunikat dotyczący karty kredytowej nie zostanie dostarczony, zamówienie może zostać wysłane bez płatności.</span><span class="sxs-lookup"><span data-stu-id="ae536-123">If the credit card message is not delivered, the order may be dispatched without payment.</span></span>

<span data-ttu-id="ae536-124">Aby uniknąć problemów tego typu można zgrupować dwa komunikaty jako transakcję.</span><span class="sxs-lookup"><span data-stu-id="ae536-124">You can avoid these kinds of problems by grouping the two messages into a transaction.</span></span> <span data-ttu-id="ae536-125">Powodzenie lub niepowodzenie transakcji odnosi się do pojedynczej jednostki.</span><span class="sxs-lookup"><span data-stu-id="ae536-125">Transactions succeed or fail as a single unit.</span></span> <span data-ttu-id="ae536-126">Jeśli dostarczenie komunikatu ze szczegółami karty kredytowej nie powiedzie się, komunikat ze szczegółami zamówienia również nie zostanie dostarczony.</span><span class="sxs-lookup"><span data-stu-id="ae536-126">If the credit card details message delivery fails then so will the order details message.</span></span>

## <a name="when-to-use-storage-queues"></a><span data-ttu-id="ae536-127">Kiedy stosować kolejki usługi Storage</span><span class="sxs-lookup"><span data-stu-id="ae536-127">When to use Storage queues</span></span>

<span data-ttu-id="ae536-128">Kolejki są używane w przypadku komunikatów, ale nie zdarzeń.</span><span class="sxs-lookup"><span data-stu-id="ae536-128">Queues are used for messages but not events.</span></span>

<span data-ttu-id="ae536-129">Konta usługi Azure Storage obejmują kolejki, które mogą być używane przez aplikacje rozproszone jako proste tymczasowe lokalizacje magazynu na potrzeby komunikatów.</span><span class="sxs-lookup"><span data-stu-id="ae536-129">Azure Storage Accounts include queues, which can be used by distributed applications as simple temporary storage locations for messages.</span></span> <span data-ttu-id="ae536-130">Składnik źródłowy może dodać komunikat do kolejki.</span><span class="sxs-lookup"><span data-stu-id="ae536-130">A source component can add a message to the queue.</span></span> <span data-ttu-id="ae536-131">Składniki docelowe pobierają ten komunikat na początku kolejki do przetworzenia.</span><span class="sxs-lookup"><span data-stu-id="ae536-131">Destination components retrieve the message at the front of the queue for processing.</span></span> <span data-ttu-id="ae536-132">Kolejki tego typu zwiększają niezawodność wymiany komunikatów, ponieważ w okresach dużego zapotrzebowania komunikaty po prostu czekają, aż ich składnik docelowy będzie gotowy do ich przetworzenia.</span><span class="sxs-lookup"><span data-stu-id="ae536-132">Such queues increase the reliability of the message exchange because, at times of high demand, messages can simply wait until a destination component is ready to process them.</span></span>

<span data-ttu-id="ae536-133">Kolejki również są oferowane jako część komunikatów usługi Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="ae536-133">Queues are also provided as part of Azure Service Bus Messaging.</span></span> <span data-ttu-id="ae536-134">Jeśli chcesz używać kolejki na platformie Azure w przypadku określonej komunikacji, musisz wybrać rozwiązanie do użycia: kolejkę usługi Storage lub kolejkę usługi Service Bus.</span><span class="sxs-lookup"><span data-stu-id="ae536-134">If you have decided to use a queue in Azure for a specific communication, you must decide whether to use a Storage queue or a Service Bus queue.</span></span>

<span data-ttu-id="ae536-135">Aby dokonać tego wyboru, odpowiedz na następujące pytania:</span><span class="sxs-lookup"><span data-stu-id="ae536-135">To make this choice, consider the following questions:</span></span>

- <span data-ttu-id="ae536-136">Czy potrzebujesz gwarancji co najwyżej jednokrotnego dostarczania?</span><span class="sxs-lookup"><span data-stu-id="ae536-136">Do you need an At-Most-Once delivery guarantee?</span></span>
- <span data-ttu-id="ae536-137">Czy potrzebujesz gwarancji FIFO?</span><span class="sxs-lookup"><span data-stu-id="ae536-137">Do you need a FIFO guarantee?</span></span>
- <span data-ttu-id="ae536-138">Czy chcesz grupować komunikaty w postaci transakcji?</span><span class="sxs-lookup"><span data-stu-id="ae536-138">Do you need to group messages into transactions?</span></span>
- <span data-ttu-id="ae536-139">Czy chcesz przechowywać komunikaty większe niż 64 KB?</span><span class="sxs-lookup"><span data-stu-id="ae536-139">Do you need to store messages larger than 64KB?</span></span>

<span data-ttu-id="ae536-140">Jeśli odpowiedź na dowolne z tych pytań jest twierdząca, musisz wybrać kolejkę usługi Service Bus.</span><span class="sxs-lookup"><span data-stu-id="ae536-140">If the answer to any of these questions is yes, you must choose to use a Service Bus queue.</span></span>

<span data-ttu-id="ae536-141">Dodatkowo zastanów się, czy:</span><span class="sxs-lookup"><span data-stu-id="ae536-141">In addition consider:</span></span>

- <span data-ttu-id="ae536-142">Czy potrzebujesz dzienników po stronie serwera w przypadku wszystkich wiadomości przechodzących przez kolejkę?</span><span class="sxs-lookup"><span data-stu-id="ae536-142">Do you need server-side logs of all messages that pass through the queue?</span></span>
- <span data-ttu-id="ae536-143">Czy oczekujesz, że rozmiar kolejki przekroczy 80 GB?</span><span class="sxs-lookup"><span data-stu-id="ae536-143">Do you expect the queue to exceed 80GB in size?</span></span>

<span data-ttu-id="ae536-144">Jeśli odpowiedź na dowolne z tych pytań jest twierdząca, musisz wybrać kolejkę usługi Storage.</span><span class="sxs-lookup"><span data-stu-id="ae536-144">If the answer to any of these questions is yes, you must choose to use a Storage queue.</span></span>

## <a name="summary"></a><span data-ttu-id="ae536-145">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="ae536-145">Summary</span></span>

<span data-ttu-id="ae536-146">Kolejka to prosta tymczasowa lokalizacja magazynu na potrzeby komunikatów wysyłanych między składnikami aplikacji rozproszonej.</span><span class="sxs-lookup"><span data-stu-id="ae536-146">A queue is a simple temporary storage location for messages sent between the components of a distributed application.</span></span> <span data-ttu-id="ae536-147">Kolejka służy do organizowania komunikatów i bezproblemowej obsługi nieprzewidywalnych wzrostów zapotrzebowania.</span><span class="sxs-lookup"><span data-stu-id="ae536-147">Use a queue to organize message and gracefully handle unpredictable surges in demand.</span></span>

<span data-ttu-id="ae536-148">Kolejek usługi Azure Storage można użyć, jeśli system kolejek ma być prosty i łatwy do kodowania.</span><span class="sxs-lookup"><span data-stu-id="ae536-148">Use Azure Storage queues when you want a simple and easy-to-code queue system.</span></span> <span data-ttu-id="ae536-149">W przypadku bardziej zaawansowanych potrzeb należy używać kolejek usługi Azure Service Bus.</span><span class="sxs-lookup"><span data-stu-id="ae536-149">For more advanced needs, use Azure Service Bus queues.</span></span>
<span data-ttu-id="8b8d2-101">Usługa Azure Key Vault używa usługi **Azure Active Directory** do uwierzytelniania użytkowników i aplikacji próbujących uzyskać dostęp do magazynu.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-101">Azure Key Vault uses **Azure Active Directory** to authenticate users and applications that try to access a vault.</span></span> <span data-ttu-id="8b8d2-102">Aby udzielić naszej aplikacji internetowej dostępu do magazynu, najpierw musimy ją zarejestrować w usłudze Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-102">To grant our web application access to the vault, we first need to register our app with Azure Active Directory.</span></span> <span data-ttu-id="8b8d2-103">Zarejestrowanie powoduje utworzenie tożsamości dla aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-103">Registering creates an identity for the app.</span></span> <span data-ttu-id="8b8d2-104">Gdy będziemy już mieć tożsamość, możemy do niej przypisać uprawnienia magazynu.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-104">Once we have an identity, we can assign vault permissions to it.</span></span>

<span data-ttu-id="8b8d2-105">Aplikacje i użytkownicy uwierzytelniają się w usłudze Key Vault przy użyciu tokenu uwierzytelniania usługi Azure Active Directory.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-105">Apps and users authenticate to Key Vault using an Azure Active Directory authentication token.</span></span> <span data-ttu-id="8b8d2-106">Uzyskanie tokenu z usługi Azure Active Directory wymaga wpisu tajnego lub certyfikatu, ponieważ każda osoba mająca token mogłaby przy użyciu tożsamości aplikacji uzyskać dostęp do wszystkich wpisów tajnych w magazynie.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-106">Getting a token from Azure Active Directory requires a secret or certificate, because anyone with a token could use the application identity to access all of the secrets in the vault.</span></span>

<span data-ttu-id="8b8d2-107">Nasze wpisy tajne aplikacji są bezpieczne w magazynie, ale musimy mieć wpis tajny lub certyfikat poza magazynem, aby uzyskiwać do nich dostęp.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-107">Our application secrets are secure in the vault, but we still need to keep a secret or certificate outside of the vault in order to access them!</span></span> <span data-ttu-id="8b8d2-108">Ten problem jest nazywany *problemem ładowania początkowego*, a platforma Azure zapewnia jego rozwiązanie.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-108">This problem is called the *bootstrapping problem*, and Azure has a solution for it.</span></span>

## <a name="managed-service-identity"></a><span data-ttu-id="8b8d2-109">Tożsamość usługi zarządzanej</span><span class="sxs-lookup"><span data-stu-id="8b8d2-109">Managed Service Identity</span></span>

<span data-ttu-id="8b8d2-110">*Tożsamość usługi zarządzanej* (MSI, Managed Service Identity) to funkcja usługi Azure App Service, której aplikacja może używać w celu uzyskiwania dostępu do usługi Key Vault i innych usług platformy Azure bez konieczności zarządzania nawet jednym wpisem tajnym.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-110">*Managed Service Identity* (MSI) is a feature of Azure App Service that your app can use to access Key Vault and other Azure services without having to manage even a single secret.</span></span> <span data-ttu-id="8b8d2-111">Korzystanie z tożsamości MSI jest łatwiejsze i bezpieczniejsze niż samodzielne zarządzanie wpisem tajnym.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-111">Using MSI is simpler and more secure than managing a secret yourself.</span></span>

<span data-ttu-id="8b8d2-112">Po włączeniu tożsamości MSI platforma Azure aktywuje oddzielną usługę REST przyznającą token specjalnie na potrzeby aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-112">When you enable MSI, Azure activates a separate token-granting REST service specifically for use by your app.</span></span> <span data-ttu-id="8b8d2-113">Gdy aplikacja zażąda tokenu z usługi tokenu MSI, usługa skontaktuje się z usługą Azure Active Directory, aby uzyskać token dla tożsamości MSI, i przekaże go z powrotem do aplikacji w celu użycia w usłudze Key Vault.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-113">When your app requests a token from the MSI token service, the service contacts Azure Active Directory to get a token for the MSI identity and hands it back to your app for use with Key Vault.</span></span> <span data-ttu-id="8b8d2-114">Najważniejszą częścią tego przepływu pracy jest sposób, w jaki aplikacja uwierzytelnia się w usłudze tokenu MSI &mdash; zamiast wpisu tajnego lub certyfikatu, którym trzeba zarządzać w konfiguracji, aplikacja używa wpisu tajnego bezpiecznie wprowadzanego przez platformę Azure do swoich zmiennych środowiskowych podczas uruchamiania.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-114">The most important part of this workflow is the way that your app authenticates to the MSI token service &mdash; instead of requiring a secret or certificate you need to manage in your configuration, your app uses a secret that Azure securely injects into its environment variables when it starts up.</span></span> <span data-ttu-id="8b8d2-115">Nie trzeba zarządzać tą wartością wpisu tajnego ani jej nigdzie przechowywać.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-115">You don't need to manage or store this secret value anywhere.</span></span> <span data-ttu-id="8b8d2-116">Ten wpis tajny oraz punkt końcowy usługi tokenu MSI jest dostępny wyłącznie dla Twojej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-116">Nothing outside of your app can access this secret or the MSI token service endpoint.</span></span>

<span data-ttu-id="8b8d2-117">Ponadto tożsamość MSI zarejestruje za Ciebie aplikację w usłudze Azure Active Directory i usunie rejestrację, jeśli wyłączysz tożsamość MSI lub usuniesz aplikację.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-117">MSI also registers your app in Azure Active Directory for you, and will delete the registration if you disable MSI or delete the app.</span></span>

<span data-ttu-id="8b8d2-118">Tożsamość MSI jest dostępna we wszystkich wersjach usługi Azure Active Directory, w tym w wersji Bezpłatna dołączonej do subskrypcji platformy Azure.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-118">MSI is available in all editions of Azure Active Directory, including the Free edition included with an Azure subscription.</span></span> <span data-ttu-id="8b8d2-119">Korzystanie z niej w usłudze App Service nie wiąże się z żadnym kosztem ani nie wymaga żadnej konfiguracji. Można ją włączyć lub wyłączyć dla aplikacji w dowolnym czasie.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-119">Using it in App Service has no extra cost and requires no configuration, and it can be enabled or disabled on an app at any time.</span></span>

> [!NOTE]
> <span data-ttu-id="8b8d2-120">Tożsamość MSI nie jest obecnie obsługiwana w przypadku systemu Linux ani internetowych aplikacji kontenera.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-120">MSI is not currently supported for Linux or Container web apps.</span></span>

<span data-ttu-id="8b8d2-121">Włączenie tożsamości MSI wymaga wydania tylko jednego polecenia interfejsu wiersza polecenia platformy Azure bez żadnej konfiguracji.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-121">Enabling MSI requires only a single Azure CLI command with no configuration.</span></span> <span data-ttu-id="8b8d2-122">Wykonamy tę czynność w sekcji 5 podczas konfigurowania aplikacji usługi App Service i wdrażania jej na platformie Azure.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-122">We'll do it in unit 5 when we set up an App Service app and deploy to Azure.</span></span> <span data-ttu-id="8b8d2-123">Jednak wcześniej skorzystamy z naszej wiedzy o tożsamości MSI w celu napisania kodu naszej aplikacji.</span><span class="sxs-lookup"><span data-stu-id="8b8d2-123">Before that, though, we're going to apply our knowledge of MSI to write the code for our app.</span></span>
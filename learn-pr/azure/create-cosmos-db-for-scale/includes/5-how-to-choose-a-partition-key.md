<span data-ttu-id="7b9eb-101">Sprzedawca internetowy, dla którego pracujesz, planuje w najbliższej przyszłości poszerzenie geograficznego obszaru działania.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-101">The online retailer that you work for plans to expand to a new geographical area in the near future.</span></span> <span data-ttu-id="7b9eb-102">Ten ruch zwiększy bazę klientów i liczbę transakcji, które obsługujesz.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-102">This move will increase your customer base and transaction volume.</span></span> <span data-ttu-id="7b9eb-103">Musisz mieć pewność, że Twoja baza danych jest przystosowana do tego rozszerzenia w każdej chwili.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-103">You must ensure that your database is equipped to handle expansion whenever required.</span></span>

<span data-ttu-id="7b9eb-104">Strategia partycjonowania gwarantuje, że gdy trzeba będzie zwiększyć bazę danych, będzie to można z łatwością zrobić i nadal wykonywać wydajne zapytania i transakcje.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-104">Having a partition strategy ensures that when your database needs to grow, it can do so easily and continue to perform efficient queries and transactions.</span></span>

## <a name="what-is-a-partition-strategy"></a><span data-ttu-id="7b9eb-105">Co to jest strategia partycjonowania?</span><span class="sxs-lookup"><span data-stu-id="7b9eb-105">What is a partition strategy?</span></span>

<span data-ttu-id="7b9eb-106">Jeśli wciąż będziesz dodawać nowe dane do pojedynczego serwera lub jednej partycji, po pewnym czasie wolne miejsce skończy się.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-106">If you continue to add new data to a single server or a single partition, it will eventually run out of space.</span></span> <span data-ttu-id="7b9eb-107">Aby się do tego przygotować, potrzebujesz strategii partycjonowania w celu **skalowania w poziomie**, a nie w pionie.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-107">To prepare for this, you need a partitioning strategy to **scale out** instead of up.</span></span> <span data-ttu-id="7b9eb-108">Skalowanie w poziomie umożliwia dodawanie kolejnych partycji do bazy danych zgodnie z potrzebami aplikacji.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-108">Scaling out is also called horizontal scaling, and it enables you to add more partitions to your database as your application needs them.</span></span>

<span data-ttu-id="7b9eb-109">Strategia partycjonowania i skalowania w poziomie w usłudze Azure Cosmos DB działa na podstawie klucza partycji, który jest wartością ustawianą podczas tworzenia kolekcji.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-109">The partition and scale-out strategy in Azure Cosmos DB is driven by the partition key, which is a value set when you create a collection.</span></span> <span data-ttu-id="7b9eb-110">Po ustawieniu klucza partycji nie można go zmienić bez ponownego tworzenia kolekcji, dlatego wybór odpowiedniego klucza partycji jest ważnym krokiem, który trzeba wykonać na wczesnym etapie procesu programowania.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-110">Once the partition key is set, it cannot be changed without recreating the collection, so selecting the right partition key is an important decision to make early in your development process.</span></span>  

<span data-ttu-id="7b9eb-111">W tym module dowiesz się, jak wybrać klucz partycji odpowiedni dla danego scenariusza, i skorzystasz z zalet skalowania automatycznego usługi Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-111">In this unit, you will learn how to choose a partition key that's right for your scenario and will take advantage of the autoscaling that Azure Cosmos DB can do for you.</span></span>

## <a name="partition-key-basics"></a><span data-ttu-id="7b9eb-112">Podstawowe informacje dotyczące klucza partycji</span><span class="sxs-lookup"><span data-stu-id="7b9eb-112">Partition key basics</span></span>

<span data-ttu-id="7b9eb-113">Klucz partycji reprezentuje wartość w Twojej bazie danych, której często dotyczą wykonywane zapytania.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-113">A partition key represent a value in your database that's frequently queried.</span></span> <span data-ttu-id="7b9eb-114">Dlatego w scenariuszu sprzedawcy internetowego użycie wartości Nazwa użytkownika lub Identyfikator produktu jako klucza partycji jest dobrym rozwiązaniem.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-114">So in an online retail scenario, using the UserID or ProductID value as the partition key is a good choice.</span></span> <span data-ttu-id="7b9eb-115">Nazwa użytkownika jest dobrym wyborem, ponieważ aplikacja często musi pobierać takie dane, jak ustawienia personalizacji, koszyk, historia zamówień i informacje o profilu użytkownika.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-115">UserID is a good choice, as your application frequently needs to retrieve the personalization settings, shopping cart, order history, and profile information for the user, just to name a few.</span></span> <span data-ttu-id="7b9eb-116">Identyfikator produktu jest również dobrym wyborem, ponieważ aplikacja musi wykonywać zapytania dotyczące poziomu zapasów, kosztów wysyłki, opcji kolorów, lokalizacji magazynu i nie tylko.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-116">ProductID is also a good choice, as your application needs to query inventory levels, shipping costs, color options, warehouse locations, and more.</span></span>

<span data-ttu-id="7b9eb-117">Klucz partycji powinien dążyć do dystrybucji operacji w bazie danych.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-117">A partition key should aim to distribute operations across the database.</span></span> <span data-ttu-id="7b9eb-118">Dystrybucja żądań pozwala uniknąć tzw. gorącej partycji.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-118">You want to distribute requests in an effort to avoid hot partitions.</span></span> <span data-ttu-id="7b9eb-119">Gorąca partycja to pojedyncza partycja, która otrzymuje o wiele więcej żądań niż inne, co może prowadzić do utworzenia wąskiego gardła przepustowości.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-119">A hot partition is a single partition that receives many more requests than the others, which can create a throughput bottleneck.</span></span> <span data-ttu-id="7b9eb-120">Na przykład w omawianej aplikacji handlu elektronicznego bieżąca godzina byłaby złym kluczem partycji, ponieważ wszystkie dane przychodzące byłyby wysyłane do pojedynczego klucza partycji.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-120">For example, for your e-commerce application, the current time would be a poor choice of partition key, because all the incoming data would go to a single partition key.</span></span> <span data-ttu-id="7b9eb-121">Nazwa użytkownika lub Identyfikator produktu byłyby lepsze, ponieważ wszyscy użytkownicy w witrynie prawdopodobnie dodawaliby i aktualizowali swoje koszyki zakupów bądź informacje o profilu mniej więcej z taką samą częstotliwością, dzięki czemu odczyty i zapisy byłyby dystrybuowane we wszystkich partycjach użytkowników.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-121">UserID or ProductID would be better, as all the users on your site would likely be adding and updating their shopping cart or profile information at about the same frequency, which distributes the reads and writes across all the user partitions.</span></span> <span data-ttu-id="7b9eb-122">Podobnie aktualizacje danych produktów także byłyby w miarę równomiernie dystrybuowane, dzięki czemu Identyfikator produktu byłby dobrym kluczem partycji.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-122">Likewise, updates to product data would also likely be fairly evenly distributed, making ProductID a good partition key choice.</span></span>

<span data-ttu-id="7b9eb-123">Maksymalne miejsce do magazynowania każdego klucza partycji wynosi 10 GB — jest to rozmiar jednej partycji fizycznej w usłudze Azure Cosmos DB.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-123">Each partition key has a maximum storage space of 10 GB, which is the size of one physical partition in Azure Cosmos DB.</span></span> <span data-ttu-id="7b9eb-124">Jeśli zatem przewidujesz, że pojedynczy rekord Identyfikator użytkownika lub Identyfikator produktu będzie większy niż 10 GB, rozważ zastosowanie klucza złożonego, aby każdy rekord był mniejszy.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-124">So if your single UserID or ProductID record is going to be larger than 10 GB, think about using a composite key instead so that each record is smaller.</span></span> <span data-ttu-id="7b9eb-125">Przykładem klucza złożonego może być kombinacja Identyfikator użytkownika-data, co wyglądałoby następująco: NazwiskoKlienta-07082018.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-125">An example of a composite key would be UserID-date, which would look like CustomerName-08072018.</span></span> <span data-ttu-id="7b9eb-126">Podejście z kluczem złożonym umożliwiłoby tworzenie nowej partycji dla każdego dnia, kiedy użytkownik odwiedzi witrynę.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-126">This composite key approach would enable you to create a new partition for each day a user visited the site.</span></span>

## <a name="best-practices"></a><span data-ttu-id="7b9eb-127">Najlepsze praktyki</span><span class="sxs-lookup"><span data-stu-id="7b9eb-127">Best practices</span></span>

<span data-ttu-id="7b9eb-128">Gdy próbujesz określić odpowiedni klucz partycji i rozwiązanie nie jest oczywiste, pamiętaj o kilku poniższych wskazówkach.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-128">When you're trying to determine the right partition key and the solution isn't obvious, here are a few tips to keep in mind.</span></span>

* <span data-ttu-id="7b9eb-129">Nie obawiaj się, że będziesz mieć zbyt wiele kluczy partycji.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-129">Don’t be afraid of having too many partition keys.</span></span> <span data-ttu-id="7b9eb-130">Im więcej kluczy partycji, tym lepsza skalowalność.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-130">The more partition keys you have, the more scalability you have.</span></span>

* <span data-ttu-id="7b9eb-131">Aby określić najlepszy klucz partycji dla obciążenia z dużą liczbą odczytów, przejrzyj od trzech do pięciu zapytań, których planujesz używać.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-131">To determine the best partition key for a read-heavy workload, review the top three to five queries you plan on using.</span></span> <span data-ttu-id="7b9eb-132">Wartość, która jest najczęściej używana w klauzuli WHERE, jest dobrym kandydatem na klucz partycji.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-132">The value most frequently included in the WHERE clause is a good candidate for the partition key.</span></span>

* <span data-ttu-id="7b9eb-133">W przypadku obciążeń z dużą liczbą zapisów należy zrozumieć transakcyjne wymagania obciążenia, ponieważ klucz partycji jest zakresem transakcji z wieloma dokumentami.</span><span class="sxs-lookup"><span data-stu-id="7b9eb-133">For write-heavy workloads, you'll need to understand the transactional needs of your workload, because the partition key is the scope of multi-document transactions.</span></span>

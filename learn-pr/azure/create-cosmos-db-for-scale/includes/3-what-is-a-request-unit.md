<span data-ttu-id="534ff-101">Następnie przyjrzyjmy się danym w naszej bazie danych.</span><span class="sxs-lookup"><span data-stu-id="534ff-101">Next we'll consider the data throughout for our database.</span></span> <span data-ttu-id="534ff-102">Ważne jest upewnienie się, że możemy obsłużyć wolumen transakcji odpowiedni do naszych potrzeb biznesowych.</span><span class="sxs-lookup"><span data-stu-id="534ff-102">This is important to ensure we can handle the volume of transactions for our business needs.</span></span> <span data-ttu-id="534ff-103">Wymagania dotyczące przepływności nie zawsze są spójne.</span><span class="sxs-lookup"><span data-stu-id="534ff-103">Throughput requirements aren't always consistent.</span></span> <span data-ttu-id="534ff-104">Na przykład możesz budować internetową witrynę zakupową, która musi być skalowana podczas wyprzedaży lub dni wolnych od pracy.</span><span class="sxs-lookup"><span data-stu-id="534ff-104">For example, you may be building a shopping website that needs to scale during sales or holidays.</span></span> <span data-ttu-id="534ff-105">Zaczniemy od oszacowania wymagań dotyczących przepływności bazy danych.</span><span class="sxs-lookup"><span data-stu-id="534ff-105">We'll start estimating your database throughput requirements.</span></span>

## <a name="what-is-database-throughput"></a><span data-ttu-id="534ff-106">Co to jest przepływność bazy danych?</span><span class="sxs-lookup"><span data-stu-id="534ff-106">What is database throughput?</span></span> 

<span data-ttu-id="534ff-107">Przepływność bazy danych to liczba operacji odczytu i zapisu, które baza danych może wykonać w ciągu jednej sekundy.</span><span class="sxs-lookup"><span data-stu-id="534ff-107">Database throughput is the number of reads and writes that your database can perform in a single second.</span></span> 

<span data-ttu-id="534ff-108">Aby strategicznie skalować przepływność, musisz oszacować potrzebną przepływność, szacując liczbę operacji odczytu i zapisu, które musisz obsłużyć w różnym czasie i w przypadku różnych rozmiarów dokumentów.</span><span class="sxs-lookup"><span data-stu-id="534ff-108">To scale throughput strategically, you need to estimate your throughput needs by estimating the number of reads and writes you'll have to support at different times and for different document sizes.</span></span> <span data-ttu-id="534ff-109">Jeśli oszacujesz to poprawnie, uszczęśliwisz swoich użytkowników, gdy pojawi się szczyt zapotrzebowania.</span><span class="sxs-lookup"><span data-stu-id="534ff-109">If you estimate correctly, you'll keep your users happy when demand spikes.</span></span> <span data-ttu-id="534ff-110">Jeśli oszacujesz to niepoprawnie, żądania mogą mieć ograniczoną prędkość i operacje będą musiały poczekać i być ponowione, co najprawdopodobniej spowoduje duże opóźnienia i niezadowolenie klientów.</span><span class="sxs-lookup"><span data-stu-id="534ff-110">If you estimate incorrectly, your requests can get rate-limited and operations will have to wait and retry, likely causing high latency and unhappy customers.</span></span>

## <a name="what-is-a-request-unit"></a><span data-ttu-id="534ff-111">Co to jest jednostka żądania?</span><span class="sxs-lookup"><span data-stu-id="534ff-111">What is a request unit?</span></span>

<span data-ttu-id="534ff-112">Usługa Azure Cosmos DB mierzy przepływność przy użyciu czegoś, co jest nazywane **jednostką żądania (RU)**.</span><span class="sxs-lookup"><span data-stu-id="534ff-112">Azure Cosmos DB measures throughput using something called a **request unit (RU)**.</span></span> <span data-ttu-id="534ff-113">Użycie jednostek żądania jest mierzone na sekundę, dzięki czemu jednostką miary jest **jednostka żądania na sekundę (RU/s)**.</span><span class="sxs-lookup"><span data-stu-id="534ff-113">Request unit usage is measured per second, so the unit of measure is **request units per second (RU/s)**.</span></span> <span data-ttu-id="534ff-114">Musisz zarezerwować taką liczbę jednostek RU/s, którą ma z wyprzedzeniem aprowizować usługa Azure Cosmos DB, aby obsłużyć oszacowane obciążenie. Następnie możesz skalować jednostki RU/s w górę lub w dół w dowolnym momencie, aby zaspokoić bieżące zapotrzebowanie.</span><span class="sxs-lookup"><span data-stu-id="534ff-114">You must reserve the number of RU/s you want Azure Cosmos DB to provision in advance, so it can handle the load you've estimated, and you can scale your RU/s up or down at any time to meet current demand.</span></span>

## <a name="request-unit-basics"></a><span data-ttu-id="534ff-115">Podstawowe informacje o jednostce żądania</span><span class="sxs-lookup"><span data-stu-id="534ff-115">Request unit basics</span></span>

<span data-ttu-id="534ff-116">Pojedyncza jednostka żądania, 1 RU, jest równa szacowanemu kosztowi wykonania pojedynczego żądania GET na dokumencie o wielkości 1 KB za pomocą identyfikatora dokumentu.</span><span class="sxs-lookup"><span data-stu-id="534ff-116">A single request unit, 1 RU, is equal to the approximate cost of performing a single GET request on a 1-KB document using a document's ID.</span></span> <span data-ttu-id="534ff-117">Wykonywanie operacji GET za pomocą identyfikatora dokumentu jest skutecznym sposobem pobierania dokumentu, a więc koszt jest mały.</span><span class="sxs-lookup"><span data-stu-id="534ff-117">Performing a GET by using a document's ID is an efficient means for retrieving a document, and thus the cost is small.</span></span> <span data-ttu-id="534ff-118">Tworzenie, zastępowanie lub usuwanie tego samego elementu wymaga dodatkowego przetwarzania przez usługę, a więc wymaga większej liczby jednostek żądania.</span><span class="sxs-lookup"><span data-stu-id="534ff-118">Creating, replacing, or deleting the same item requires additional processing by the service, and therefore requires more request units.</span></span>

<span data-ttu-id="534ff-119">Liczba jednostek żądania użytych do zmian operacji zmienia się w zależności od rozmiaru dokumentu, liczby właściwości w dokumencie, wykonywanej operacji i niektórych dodatkowych złożonych pojęć, takich jak spójność i zasady indeksowania.</span><span class="sxs-lookup"><span data-stu-id="534ff-119">The number of request units used for an operation changes depending on the document size, the number of properties in the document, the operation being performed, and some additional complex concepts such as consistency and indexing policy.</span></span>

<span data-ttu-id="534ff-120">W poniższej tabeli przedstawiono liczbę jednostek żądania wymaganych dla elementów w trzech różnych rozmiarach (1 KB, 4 KB i 64 KB) i na dwóch różnych poziomach wydajności (500 operacji odczytu na sekundę + 100 operacji zapisu na sekundę oraz 500 operacji odczytu na sekundę + 500 operacji zapisu na sekundę).</span><span class="sxs-lookup"><span data-stu-id="534ff-120">The following table shows the number of request units required for items of three different sizes (1 KB, 4 KB, and 64 KB) and at two different performance levels (500 reads/second + 100 writes/second and 500 reads/second + 500 writes/second).</span></span> <span data-ttu-id="534ff-121">W tym przykładzie spójność danych została ustawiona na **Sesja**, a zasady indeksowania — na **Brak**.</span><span class="sxs-lookup"><span data-stu-id="534ff-121">In this example, the data consistency is set to **Session**, and the indexing policy is set to **None**.</span></span>

| <span data-ttu-id="534ff-122">Rozmiar elementu</span><span class="sxs-lookup"><span data-stu-id="534ff-122">Item size</span></span> | <span data-ttu-id="534ff-123">Odczyty/s</span><span class="sxs-lookup"><span data-stu-id="534ff-123">Reads/second</span></span> | <span data-ttu-id="534ff-124">Zapisy/s</span><span class="sxs-lookup"><span data-stu-id="534ff-124">Writes/second</span></span> | <span data-ttu-id="534ff-125">Jednostki żądania</span><span class="sxs-lookup"><span data-stu-id="534ff-125">Request units</span></span>
| --- | --- | --- | --- |
| <span data-ttu-id="534ff-126">1 KB</span><span class="sxs-lookup"><span data-stu-id="534ff-126">1 KB</span></span> | <span data-ttu-id="534ff-127">500</span><span class="sxs-lookup"><span data-stu-id="534ff-127">500</span></span> | <span data-ttu-id="534ff-128">100</span><span class="sxs-lookup"><span data-stu-id="534ff-128">100</span></span> | <span data-ttu-id="534ff-129">(500 * 1) + (100 * 5) = 1000 RU/s</span><span class="sxs-lookup"><span data-stu-id="534ff-129">(500 * 1) + (100 * 5) = 1,000 RU/s</span></span>
| <span data-ttu-id="534ff-130">1 KB</span><span class="sxs-lookup"><span data-stu-id="534ff-130">1 KB</span></span> | <span data-ttu-id="534ff-131">500</span><span class="sxs-lookup"><span data-stu-id="534ff-131">500</span></span> | <span data-ttu-id="534ff-132">500</span><span class="sxs-lookup"><span data-stu-id="534ff-132">500</span></span> | <span data-ttu-id="534ff-133">(500 * 1) + (500 * 5) = 3000 RU/s</span><span class="sxs-lookup"><span data-stu-id="534ff-133">(500 * 1) + (500 * 5) = 3,000 RU/s</span></span>
| <span data-ttu-id="534ff-134">4 KB</span><span class="sxs-lookup"><span data-stu-id="534ff-134">4 KB</span></span> | <span data-ttu-id="534ff-135">500</span><span class="sxs-lookup"><span data-stu-id="534ff-135">500</span></span> | <span data-ttu-id="534ff-136">100</span><span class="sxs-lookup"><span data-stu-id="534ff-136">100</span></span> | <span data-ttu-id="534ff-137">(500 * 1,3) + (100 * 7) = 1350 RU/s</span><span class="sxs-lookup"><span data-stu-id="534ff-137">(500 * 1.3) + (100 * 7) = 1,350 RU/s</span></span>
| <span data-ttu-id="534ff-138">4 KB</span><span class="sxs-lookup"><span data-stu-id="534ff-138">4 KB</span></span> | <span data-ttu-id="534ff-139">500</span><span class="sxs-lookup"><span data-stu-id="534ff-139">500</span></span> | <span data-ttu-id="534ff-140">500</span><span class="sxs-lookup"><span data-stu-id="534ff-140">500</span></span> | <span data-ttu-id="534ff-141">(500 * 1,3) + (500 * 7) = 4150 RU/s</span><span class="sxs-lookup"><span data-stu-id="534ff-141">(500 * 1.3) + (500 * 7) = 4,150 RU/s</span></span>
| <span data-ttu-id="534ff-142">64 KB</span><span class="sxs-lookup"><span data-stu-id="534ff-142">64 KB</span></span> | <span data-ttu-id="534ff-143">500</span><span class="sxs-lookup"><span data-stu-id="534ff-143">500</span></span> | <span data-ttu-id="534ff-144">100</span><span class="sxs-lookup"><span data-stu-id="534ff-144">100</span></span> | <span data-ttu-id="534ff-145">(500 * 10) + (100 * 48) = 9800 RU/s</span><span class="sxs-lookup"><span data-stu-id="534ff-145">(500 * 10) + (100 * 48) = 9,800 RU/s</span></span>
| <span data-ttu-id="534ff-146">64 KB</span><span class="sxs-lookup"><span data-stu-id="534ff-146">64 KB</span></span> | <span data-ttu-id="534ff-147">500</span><span class="sxs-lookup"><span data-stu-id="534ff-147">500</span></span> | <span data-ttu-id="534ff-148">500</span><span class="sxs-lookup"><span data-stu-id="534ff-148">500</span></span> | <span data-ttu-id="534ff-149">(500 * 10) + (500 * 48) = 29 000 RU/s</span><span class="sxs-lookup"><span data-stu-id="534ff-149">(500 * 10) + (500 * 48) = 29,000 RU/s</span></span>
 
<span data-ttu-id="534ff-150">Jak widać, im większy jest element i im więcej odczytów i zapisów jest wymaganych, tym więcej jednostek żądania należy zarezerwować.</span><span class="sxs-lookup"><span data-stu-id="534ff-150">As you can see, the larger the item is, and the more reads and writes are required, the more request units you need to reserve.</span></span> <span data-ttu-id="534ff-151">Jeśli trzeba oszacować potrzebną przepływność aplikacji, [Planista wydajności](https://www.documentdb.com/capacityplanner) usługi Azure Cosmos DB jest narzędziem internetowym, które pozwala przekazać przykładowy dokument JSON i ustawić liczbę operacji, które należy wykonać na sekundę.</span><span class="sxs-lookup"><span data-stu-id="534ff-151">If you need to estimate the throughput needs of an application, the Azure Cosmos DB [Capacity Planner](https://www.documentdb.com/capacityplanner) is an online tool that enables you to upload a sample JSON document and set the number of operations you need to complete per second.</span></span> <span data-ttu-id="534ff-152">Następnie podaje on oszacowaną wartość całkowitą do zarezerwowania.</span><span class="sxs-lookup"><span data-stu-id="534ff-152">It then provides an estimated total to reserve.</span></span>

## <a name="exceeding-throughput-limits"></a><span data-ttu-id="534ff-153">Przekraczanie limitów przepływności</span><span class="sxs-lookup"><span data-stu-id="534ff-153">Exceeding throughput limits</span></span>

<span data-ttu-id="534ff-154">Jeśli nie zarezerwujesz wystarczającej liczby jednostek żądania i podejmiesz próbę odczytu lub zapisu większej ilości danych niż zezwala aprowizowana przepływność, żądanie będzie miało ograniczoną szybkość.</span><span class="sxs-lookup"><span data-stu-id="534ff-154">If you don’t reserve enough request units, and you attempt to read or write more data than your provisioned throughput allows, your request will be rate-limited.</span></span> <span data-ttu-id="534ff-155">Gdy żądanie ma ograniczoną szybkość, musi nastąpić próba jego ponownego wykonania po upływie określonego czasu.</span><span class="sxs-lookup"><span data-stu-id="534ff-155">When a request is rate-limited, the request has to be retried again after a specified interval.</span></span> <span data-ttu-id="534ff-156">Jeśli używasz zestawu .NET SDK, żądanie zostanie automatycznie ponowione po odczekaniu czasu określonego w nagłówku retry-after (ponów po).</span><span class="sxs-lookup"><span data-stu-id="534ff-156">If you use the .NET SDK, the request will be retried automatically after waiting the amount of time specified in the retry-after header.</span></span>

## <a name="creating-an-account-built-to-scale"></a><span data-ttu-id="534ff-157">Tworzenie konta utworzonego pod kątem skalowania</span><span class="sxs-lookup"><span data-stu-id="534ff-157">Creating an account built to scale</span></span>

<span data-ttu-id="534ff-158">W każdej chwili możesz zmienić liczbę jednostek żądania aprowizowanych do bazy danych.</span><span class="sxs-lookup"><span data-stu-id="534ff-158">You can change the number of request units provisioned to a database at any time.</span></span> <span data-ttu-id="534ff-159">Dlatego w okresach dużych obciążeń możesz skalować w górę, aby uwzględnić duże zapotrzebowanie, a następnie zmniejszyć aprowizowaną przepływność poza godzinami szczytu w celu zmniejszenia kosztów.</span><span class="sxs-lookup"><span data-stu-id="534ff-159">So, during heavy volume periods, you can scale up to accommodate those high demands, and then reduce provisioned throughput during off peak times to reduce costs.</span></span>

<span data-ttu-id="534ff-160">Podczas tworzenia konta możesz aprowizować w portalu co najmniej 400 RU/s lub co najwyżej 250 000 RU/s.</span><span class="sxs-lookup"><span data-stu-id="534ff-160">When you create an account, you can provision a minimum of 400 RU/s, or a maximum of 250,000 RU/s in the portal.</span></span> <span data-ttu-id="534ff-161">Jeśli potrzebujesz jeszcze większej przepływności, wypełnij bilet w witrynie Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="534ff-161">If you need even more throughput, fill out a ticket in the Azure portal.</span></span> <span data-ttu-id="534ff-162">Ustawienie początkowej przepływności na 1000 RU/s jest zalecane dla prawie wszystkich kont, ponieważ jest to minimalna wartość, przy której baza danych będzie automatycznie skalowana, jeśli będziesz potrzebować więcej niż 10 GB pamięci masowej.</span><span class="sxs-lookup"><span data-stu-id="534ff-162">Setting the initial throughput to 1000 RU/s is recommended for almost all accounts, as it is the minimum value in which your database will autoscale should you need more than 10 GB of storage.</span></span> <span data-ttu-id="534ff-163">Jeśli ustawisz początkową przepływność na dowolną wartość mniejszą niż 1000 RU/s, Twoja baza danych nie będzie skalowana do wielkości przekraczającej 10 GB, chyba że ponownie aprowizujesz bazę danych i podasz klucz partycji.</span><span class="sxs-lookup"><span data-stu-id="534ff-163">If you set the initial throughput to any value less than 1000 RU/s, your database will not be able to scale to larger than 10 GB unless you reprovision the database and provide a partition key.</span></span> <span data-ttu-id="534ff-164">Klucze partycji pozwalają na szybkie wyszukiwanie danych w usłudze Azure Cosmos DB i umożliwiają jej automatyczne skalowanie bazy danych w razie potrzeby.</span><span class="sxs-lookup"><span data-stu-id="534ff-164">Partition keys enable quick lookup of data in Azure Cosmos DB and enable it to autoscale your database when needed.</span></span> <span data-ttu-id="534ff-165">Klucze partycji zostały omówione w następnej części.</span><span class="sxs-lookup"><span data-stu-id="534ff-165">Partition keys are discussed in the next unit.</span></span>

## <a name="summary"></a><span data-ttu-id="534ff-166">Podsumowanie</span><span class="sxs-lookup"><span data-stu-id="534ff-166">Summary</span></span>

<span data-ttu-id="534ff-167">Teraz rozumiesz sposób szacowania i określania zakresu przepływności dla usługi Azure Cosmos DB przy użyciu jednostek żądania.</span><span class="sxs-lookup"><span data-stu-id="534ff-167">You now understand how to estimate and scope throughput for an Azure Cosmos DB using request units.</span></span> <span data-ttu-id="534ff-168">Jednostki żądania można zmodyfikować w dowolnym momencie, a ustawienie ich na 1000 RU/s podczas tworzenia konta pozwala zagwarantować, że baza danych jest gotowa do późniejszego skalowania.</span><span class="sxs-lookup"><span data-stu-id="534ff-168">Request units can be modified at any time, and setting them to 1000 RU/s when you create an account helps ensure your database is ready to scale later.</span></span>